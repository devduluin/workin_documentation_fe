{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/middleware.js"],"sourcesContent":["import { NextResponse } from \"next/server\";\r\nimport { jwtVerify } from \"jose\";\r\n\r\nconst SECRET = new TextEncoder().encode(process.env.JWT_SECRET || \"mrblue_*\");\r\n\r\nexport async function middleware(req) {\r\n  const url = req.nextUrl;\r\n  const { pathname } = url;\r\n  const token = req.cookies.get(\"token\")?.value;\r\n\r\n  // üîπ Abaikan file statis & API internal\r\n  if (\r\n    pathname.startsWith(\"/_next\") ||\r\n    pathname.startsWith(\"/api\") ||\r\n    pathname.startsWith(\"/images\") ||\r\n    pathname === \"/favicon.ico\"\r\n  ) {\r\n    return NextResponse.next();\r\n  }\r\n\r\n  // üîπ Halaman login\r\n  if (pathname === \"/login\") {\r\n    if (!token) return NextResponse.next(); // belum login ‚Üí lanjut\r\n    try {\r\n      const { payload } = await jwtVerify(token, SECRET);\r\n      if (payload.role === \"admin\") {\r\n        console.log(\"‚úÖ Sudah login admin ‚Üí redirect ke dashboard2\");\r\n        return NextResponse.redirect(new URL(\"/dashboard2\", req.url));\r\n      }\r\n      // role lain (user biasa) ‚Üí ke dashboard publik\r\n      return NextResponse.redirect(new URL(\"/dashboard-publik\", req.url));\r\n    } catch {\r\n      return NextResponse.next();\r\n    }\r\n  }\r\n\r\n  // üîπ Proteksi dashboard admin\r\n  if (pathname.startsWith(\"/dashboard2\")) {\r\n    if (!token) {\r\n      console.log(\"‚ùå Tidak ada token ‚Üí redirect ke login\");\r\n      return NextResponse.redirect(new URL(\"/login\", req.url));\r\n    }\r\n\r\n    try {\r\n      const { payload } = await jwtVerify(token, SECRET);\r\n      if (payload.role !== \"admin\") {\r\n        console.log(\"üö´ Bukan admin ‚Üí arahkan ke dashboard publik\");\r\n        return NextResponse.redirect(new URL(\"/dashboard-publik\", req.url));\r\n      }\r\n      console.log(\"‚úÖ Token valid & admin ‚Üí lanjut\");\r\n      return NextResponse.next();\r\n    } catch (err) {\r\n      console.log(\"‚ùå Token rusak/expired ‚Üí login lagi\");\r\n      return NextResponse.redirect(new URL(\"/login\", req.url));\r\n    }\r\n  }\r\n\r\n  // üîπ Halaman lain bebas diakses\r\n  return NextResponse.next();\r\n}\r\n\r\n// üîπ Cakupan middleware (hanya dashboard2 & login)\r\nexport const config = {\r\n  matcher: [\"/dashboard2/:path*\", \"/login\"],\r\n};\r\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;AACA;;;AAEA,MAAM,SAAS,IAAI,cAAc,MAAM,CAAC,QAAQ,GAAG,CAAC,UAAU,IAAI;AAE3D,eAAe,WAAW,GAAG;IAClC,MAAM,MAAM,IAAI,OAAO;IACvB,MAAM,EAAE,QAAQ,EAAE,GAAG;IACrB,MAAM,QAAQ,IAAI,OAAO,CAAC,GAAG,CAAC,UAAU;IAExC,wCAAwC;IACxC,IACE,SAAS,UAAU,CAAC,aACpB,SAAS,UAAU,CAAC,WACpB,SAAS,UAAU,CAAC,cACpB,aAAa,gBACb;QACA,OAAO,gMAAY,CAAC,IAAI;IAC1B;IAEA,mBAAmB;IACnB,IAAI,aAAa,UAAU;QACzB,IAAI,CAAC,OAAO,OAAO,gMAAY,CAAC,IAAI,IAAI,uBAAuB;QAC/D,IAAI;YACF,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAA,4KAAS,EAAC,OAAO;YAC3C,IAAI,QAAQ,IAAI,KAAK,SAAS;gBAC5B,QAAQ,GAAG,CAAC;gBACZ,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,eAAe,IAAI,GAAG;YAC7D;YACA,+CAA+C;YAC/C,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,qBAAqB,IAAI,GAAG;QACnE,EAAE,OAAM;YACN,OAAO,gMAAY,CAAC,IAAI;QAC1B;IACF;IAEA,8BAA8B;IAC9B,IAAI,SAAS,UAAU,CAAC,gBAAgB;QACtC,IAAI,CAAC,OAAO;YACV,QAAQ,GAAG,CAAC;YACZ,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,IAAI,GAAG;QACxD;QAEA,IAAI;YACF,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAA,4KAAS,EAAC,OAAO;YAC3C,IAAI,QAAQ,IAAI,KAAK,SAAS;gBAC5B,QAAQ,GAAG,CAAC;gBACZ,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,qBAAqB,IAAI,GAAG;YACnE;YACA,QAAQ,GAAG,CAAC;YACZ,OAAO,gMAAY,CAAC,IAAI;QAC1B,EAAE,OAAO,KAAK;YACZ,QAAQ,GAAG,CAAC;YACZ,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,IAAI,GAAG;QACxD;IACF;IAEA,gCAAgC;IAChC,OAAO,gMAAY,CAAC,IAAI;AAC1B;AAGO,MAAM,SAAS;IACpB,SAAS;QAAC;QAAsB;KAAS;AAC3C"}}]
}