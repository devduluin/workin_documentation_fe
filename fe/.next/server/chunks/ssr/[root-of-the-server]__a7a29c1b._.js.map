{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///C:/hrisguide/Frontend/src/app/dashboard/page.js"],"sourcesContent":["\"use client\";\r\nimport { useState, useEffect } from \"react\";\r\nimport { Plus, Pencil, Trash } from \"lucide-react\";\r\nimport Link from \"next/link\";\r\nimport { useRouter } from \"next/navigation\";\r\n\r\nexport default function DashboardPage() {\r\n  const router = useRouter();\r\n  const [documents, setDocuments] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [activeCategory, setActiveCategory] = useState(null);\r\n  const [authChecked, setAuthChecked] = useState(false);\r\n\r\n  // ðŸ”¹ Cek session user berdasarkan cookie httpOnly\r\n  const checkAuth = async () => {\r\n    try {\r\n      const res = await fetch(\"/api/auth/me\", {\r\n        method: \"GET\",\r\n        credentials: \"include\",\r\n      });\r\n\r\n      if (!res.ok) {\r\n        router.push(\"/dashboard/login\");\r\n        return;\r\n      }\r\n\r\n      setAuthChecked(true);\r\n    } catch (err) {\r\n      console.error(\"Auth check error:\", err);\r\n      router.push(\"/dashboard/login\");\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    checkAuth();\r\n  }, []);\r\n\r\n  // ðŸ”¹ Ambil documents dari backend\r\n  const fetchDocuments = async (categoryId = null) => {\r\n    try {\r\n      let url = \"http://localhost:5000/api/documents\";\r\n      if (categoryId) url += `?categoryId=${categoryId}`;\r\n\r\n      const res = await fetch(url, {\r\n        method: \"GET\",\r\n        credentials: \"include\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n      });\r\n\r\n      if (res.status === 403 || res.status === 401) {\r\n        alert(\"Akses ditolak. Silakan login ulang.\");\r\n        router.push(\"/dashboard/login\");\r\n        return;\r\n      }\r\n\r\n      const data = await res.json();\r\n\r\n      if (Array.isArray(data)) setDocuments(data);\r\n      else if (data.data && Array.isArray(data.data)) setDocuments(data.data);\r\n      else setDocuments([]);\r\n\r\n      setLoading(false);\r\n    } catch (err) {\r\n      console.error(\"Error fetching documents:\", err);\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (authChecked) {\r\n      fetchDocuments();\r\n    }\r\n  }, [authChecked]);\r\n\r\n  const handleCategoryClick = (id) => {\r\n    setActiveCategory(id);\r\n    fetchDocuments(id);\r\n  };\r\n\r\n  const handleLogout = async () => {\r\n    await fetch(\"/api/auth/logout\", {\r\n      method: \"POST\",\r\n      credentials: \"include\",\r\n    });\r\n\r\n    router.replace(\"/dashboard/login\");\r\n    window.location.reload();\r\n  };\r\n\r\n  const handleDelete = async (id) => {\r\n    const confirmDelete = window.confirm(\"Yakin ingin menghapus dokumen ini?\");\r\n    if (!confirmDelete) return;\r\n\r\n    try {\r\n      const res = await fetch(`http://localhost:5000/api/documents/${id}`, {\r\n        method: \"DELETE\",\r\n        credentials: \"include\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n      });\r\n\r\n      if (res.ok) {\r\n        alert(\"Dokumen berhasil dihapus\");\r\n        fetchDocuments(activeCategory);\r\n      } else {\r\n        const err = await res.json();\r\n        alert(\"Gagal menghapus dokumen: \" + (err.message || \"unknown\"));\r\n      }\r\n    } catch (e) {\r\n      console.error(e);\r\n      alert(\"Terjadi kesalahan saat menghapus dokumen\");\r\n    }\r\n  };\r\n\r\n  if (!authChecked) {\r\n    return <p>Memeriksa sesi login...</p>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex min-h-screen bg-gray-50\">\r\n      {/* Sidebar */}\r\n      <aside className=\"w-64 bg-gray-100 p-4 border-r fixed top-0 left-0 h-screen overflow-y-auto\">\r\n        <h2 className=\"font-bold text-lg mb-4\">HRMS Documentation</h2>\r\n        <nav className=\"flex flex-col gap-2\">\r\n          {[\r\n            { id: 1, name: \"Overview\" },\r\n            { id: 2, name: \"Getting Started\" },\r\n            { id: 3, name: \"Employee Management\" },\r\n            { id: 4, name: \"Claim & Travel\" },\r\n            { id: 5, name: \"Shift & Attendance\" },\r\n            { id: 6, name: \"Leaves\" },\r\n            { id: 7, name: \"Company\" },\r\n            { id: 8, name: \"Payroll\" },\r\n          ].map((cat) => (\r\n            <button\r\n              key={cat.id}\r\n              onClick={() => handleCategoryClick(cat.id)}\r\n              className={`px-3 py-2 rounded text-left font-medium ${\r\n                activeCategory === cat.id ? \"bg-gray-300\" : \"hover:bg-gray-200\"\r\n              }`}\r\n            >\r\n              {cat.name}\r\n            </button>\r\n          ))}\r\n\r\n          <button\r\n            className=\"px-3 py-2 rounded bg-gray-300 mt-4\"\r\n            onClick={handleLogout}\r\n          >\r\n            Logout\r\n          </button>\r\n        </nav>\r\n      </aside>\r\n\r\n      {/* Main Content */}\r\n      <main className=\"flex-1 ml-64 overflow-y-auto p-6 min-h-screen\">\r\n        <div className=\"flex justify-between items-center mb-6\">\r\n  <h1 className=\"text-2xl font-bold\">Dashboard Admin</h1>\r\n  <div className=\"flex gap-3\">\r\n    <Link href=\"/dashboard/categories\">\r\n      <button className=\"px-4 py-2 bg-blue-600 text-white rounded shadow hover:bg-blue-700\">\r\n        Kelola Kategori\r\n      </button>\r\n    </Link>\r\n    <Link href=\"/dashboard/documents/new\">\r\n      <button className=\"px-4 py-2 bg-green-600 text-white rounded shadow hover:bg-green-700\">\r\n        Tambah Dokumen Baru\r\n      </button>\r\n    </Link>\r\n  </div>\r\n</div>\r\n\r\n\r\n        {loading ? (\r\n          <p>Loading...</p>\r\n        ) : (\r\n          <table className=\"w-full bg-white shadow rounded border-collapse\">\r\n            <thead className=\"bg-gray-200 text-left\">\r\n              <tr>\r\n                <th className=\"p-3 w-[60px] text-center\">ID</th>\r\n                <th className=\"p-3 w-[250px]\">Halaman Panduan</th>\r\n                <th className=\"p-3 w-[120px] text-center\">Category ID</th>\r\n                <th className=\"p-3 w-[180px] text-center\">\r\n                  Terakhir Diperbarui\r\n                </th>\r\n                <th className=\"p-3 w-[120px] text-center\">Aksi</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {documents.map((doc, index) => (\r\n                <tr key={doc.id || index} className=\"border-t hover:bg-gray-50\">\r\n                  <td className=\"p-3 text-center\">{doc.id}</td>\r\n                  <td className=\"p-3 font-medium\">{doc.title}</td>\r\n                  <td className=\"p-3 text-center\">{doc.categoryId || \"-\"}</td>\r\n                  <td className=\"p-3 text-center\">\r\n                    {doc.updatedAt\r\n                      ? new Date(doc.updatedAt).toLocaleDateString(\"id-ID\")\r\n                      : \"-\"}\r\n                  </td>\r\n                  <td className=\"p-3 flex justify-center gap-2\">\r\n                    <Link href={`/dashboard/sections/${doc.id}/new`}>\r\n                      <button className=\"p-2 text-green-600 hover:text-green-800\">\r\n                        <Plus size={18} />\r\n                      </button>\r\n                    </Link>\r\n\r\n                    <Link href={`/dashboard/sections/${doc.id}/edit`}>\r\n                      <button className=\"p-2 text-blue-600 hover:text-blue-800\">\r\n                        <Pencil size={18} />\r\n                      </button>\r\n                    </Link>\r\n\r\n                    <button\r\n                      onClick={() => handleDelete(doc.id)}\r\n                      className=\"p-2 text-red-600 hover:text-red-800\"\r\n                      title=\"Hapus dokumen\"\r\n                    >\r\n                      <Trash size={18} />\r\n                    </button>\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        )}\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}